var micHighlighter=document.querySelector("#mic-highlighter"),listening=document.querySelector("#listening"),isWokenUp=!1,drillDownTrg=document.querySelector("#drillDownTrg"),transitionVideoStartFrameImg=document.querySelector("#transition-video-start-frame-img"),transitionVideoSrc=document.querySelector("#security-posture-transition-src"),transitionVideoVid=document.querySelector("#security-posture-transition-vid"),transitionReverseVideoSrc=document.querySelector("#security-posture-transition-reverse-src"),transitionReverseVideoVid=document.querySelector("#security-posture-transition-reverse-vid"),transitionVideoEndFrameImg=document.querySelector("#transition-video-end-frame-img"),questionMarkImg=document.querySelector("#question-mark-img"),assistantHelpImg=document.querySelector("#assistant-help-img"),micImg=document.querySelector("#mic-img"),zoomedIn=!1,msg=new SpeechSynthesisUtterance;speech=annyang,msg.volume=parseFloat(6),msg.voice=speechSynthesis.getVoices().filter(function(a){return"Google US English"==a.name})[0],msg.rate=1.5;var wakeup=function(){say("What can I do for you?"),isWokenUp=!0,micHighlighter.emit("wakeup"),listening.emit("appear")},sleep=function(){isWokenUp=!1,micHighlighter.emit("sleep"),listening.emit("disappear")},say=function(a){msg.text=a,window.speechSynthesis.speak(msg)},showHelp=function(){say("Hi, I'm the Tachyon assistant. You can ask me to perform certain actions. The list with the instructions I understand is shown to the left."),showTextFeedback("This is what I can do at the moment"),assistantHelpImg.setAttribute("visible","true"),assistantHelpImg.emit("appear"),setTimeout(function(){assistantHelpImg.emit("disappear"),setTimeout(function(){assistantHelpImg.setAttribute("visible","false")},1e3)},2e4)},showTextFeedback=function(a){var b=$("<a-entity id='textFeedback' bmfont-text='text: "+a+"; color: #cccccc' visible='false' scale='.3 .3 .3' position='-.85 2.4 0' look-at='[camera]'><a-animation attribute='visible' begin='appear' from='false' to='true'></a-animation><a-animation attribute='position' begin='appear' from='-.85 2.2 0' to='-.85 2.3 0' duration='1000'></a-animation><a-animation attribute='opacity' begin='appear' from='0' to='1' duration='1000'></a-animation><a-animation attribute='position' begin='disappear' from='-.85 2.3 0' to='-.85 2.2 0' duration='1000'></a-animation><a-animation attribute='opacity' begin='disappear' from='1' to='0' duration='1000'></a-animation><a-animation attribute='visible' begin='disappear' from='true' to='false'></a-animation></a-entity>");$("#textFeedback")&&$("#textFeedback").remove(),$("a-scene").append(b),setTimeout(function(){document.querySelector("#textFeedback").emit("appear")},100),setTimeout(function(){document.querySelector("#textFeedback").emit("disappear")},2e3)};if(questionMarkImg.addEventListener("click",function(){showHelp()}),micImg.addEventListener("click",function(){wakeup(),setTimeout(function(){sleep()},5e3)}),annyang){var commands={"ok wake up":function(){wakeup()},"zoom into *node":function(a){isWokenUp&&(say("Zooming into "+a),showTextFeedback("Zooming into "+a),drillDownTrg.setAttribute("visible","false"),transitionVideoStartFrameImg.setAttribute("visible","false"),transitionVideoVid.setAttribute("visible","true"),transitionVideoSrc.play(),setTimeout(function(){transitionVideoVid.setAttribute("visible","false"),transitionVideoEndFrameImg.setAttribute("visible","true"),drillDownTrg.setAttribute("visible","false"),drillUpTrg.setAttribute("visible","true"),transitionVideoSrc.load()},9600),zoomedIn=!0,sleep())},"zoom out":function(){if(isWokenUp){if(zoomedIn){say("Ok, zooming out"),showTextFeedback("Zooming out"),drillUpTrg.setAttribute("visible","false"),transitionVideoEndFrameImg.setAttribute("visible","false"),transitionReverseVideoVid.setAttribute("visible","true"),transitionReverseVideoSrc.play(),setTimeout(function(){transitionReverseVideoVid.setAttribute("visible","false"),transitionVideoStartFrameImg.setAttribute("visible","true"),drillUpTrg.setAttribute("visible","false"),drillDownTrg.setAttribute("visible","true"),transitionReverseVideoSrc.load()},2200);$("<a-entity id='zoomOut' bmfont-text='text: Zooming out; color: #cccccc' visible='false' scale='.3 .3 .3' position='-.85 2.4 0' look-at='[camera]'><a-animation attribute='visible' begin='appear' from='false' to='true'></a-animation><a-animation attribute='position' begin='appear' from='-.85 2.2 0' to='-.85 2.3 0' duration='1000'></a-animation><a-animation attribute='opacity' begin='appear' from='0' to='1' duration='1000'></a-animation><a-animation attribute='position' begin='disappear' from='-.85 2.3 0' to='-.85 2.2 0' duration='1000'></a-animation><a-animation attribute='opacity' begin='disappear' from='1' to='0' duration='1000'></a-animation><a-animation attribute='visible' begin='disappear' from='true' to='false'></a-animation></a-entity>");zoomedIn=!1}else say("You need to zoom in before zooming out. To zoom in, say zoom into Oracle for example.");sleep()}},"I need help":function(){showHelp(),sleep()}};annyang.addCommands(commands),annyang.start()}